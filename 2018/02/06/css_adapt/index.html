<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"><title>vv13</title><link rel="stylesheet" href="/style/index.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_438575_w9o3rescwyp919k9.css"><link rel="icon" href="/undefined"></head><body><div id="content-outer"><link rel="stylesheet" href="/static/github-markdown.css"><article class="markdown-body" id="post"><h1 class="article-title">移动端适配</h1><div class="title-info"><time class="post-time" datetime="2018-02-05T16:50:00.000Z">2.6, 2018</time><div class="title-item"><a href="/tags/web/"><i class="iconfont icon-tag">web</i></a></div></div><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><h3 id="屏幕尺寸"><a href="#屏幕尺寸" class="headerlink" title="屏幕尺寸"></a>屏幕尺寸</h3><p>屏幕尺寸即屏幕对角线之间的距离，单位为英寸(inch)。单位换算如下：</p>
<ul>
<li>1 inch = 2.54 cm</li>
<li>1 cm = 0.3937inch</li>
</ul>
<h3 id="分辨率"><a href="#分辨率" class="headerlink" title="分辨率"></a>分辨率</h3><p>分辨率大致分为两种：</p>
<ol>
<li>屏幕分辨率，例如屏幕分辨率为1920 x 1080，代表着设备屏幕水平方向有1024个像素点，垂直方向有1080个像素点，显示屏固定的情况下，分辨率越高画面越精细。</li>
<li>图像分辨率，通常情况下，图像的分辨率越高，所包含的像素就越多，图像就越清晰，印刷的质量也就越好。同时，它也会增加文件占用的存储空间。</li>
</ol>
<h3 id="页面尺寸单位"><a href="#页面尺寸单位" class="headerlink" title="页面尺寸单位"></a>页面尺寸单位</h3><p>相对单位：</p>
<ul>
<li><strong>px</strong>，通常代表一个设备像素点的显示，对于打印机和高分辨率屏幕，一个css像素意味着多个设备像素。</li>
<li><strong>%</strong>，相对于目前容器元素宽度的百分比。</li>
</ul>
<ul>
<li><strong>em</strong>，相对于父及单位的font-size取值，如果容器font-size为18px，此时1em=18px。在使用em时需要尤其注意，em单位会具有继承效果，继承于离它最近元素的font-size，如出现em嵌套使用，那么将会很难对其进行管理，em通常用于某独立的组件的响应设计上，不要嵌套不相关的元素在里面使用。</li>
<li><strong>rem</strong>，相对于根html的font-size取值，如果页面具有：<code>html{font-size:20px;}</code>，此时<code>1rem=20px</code>。</li>
<li><strong>ex</strong>，表示字体的x-height，通常为字体尺寸的1/2，1ex≈0.5em。</li>
<li><strong>无单位</strong>，当设置单位为0时可以不指定具体单位，行高也可以不设置单位。</li>
</ul>
<p>绝对单位(多用于印刷)：</p>
<ul>
<li><strong>cm/mm/in</strong>，即厘米/毫米/英寸。</li>
<li><strong>pt</strong>，磅(1/72英寸)。</li>
<li><strong>pc</strong>，12点活体字。</li>
</ul>
<p>视口单位：</p>
<ul>
<li><strong>vw/vh</strong>，分别相对于视口宽度的1/100和视口高度的1/100。</li>
<li><strong>vmin/vmax</strong>，视口高度和宽度之间的最小值的1/100。</li>
<li><strong>vmax</strong>，视口高度和宽度之间的最大值得1/100。</li>
</ul>
<h2 id="像素"><a href="#像素" class="headerlink" title="像素"></a>像素</h2><p>像素(pixel)是组成图像的最小显示单位，它是一个抽象的单位，而不是具体的长度，在Web开发中通常将像素分为两类：</p>
<ol>
<li><strong>设备像素</strong>，指设备的物理像素，任何设备屏幕的物理像素的数量都是不变的。</li>
<li><strong>CSS像素</strong>，指设备的逻辑像素，也称为独立像素，是一个相对的单位大小。1个CSS像素在不同设备上对应不同的物理像素数，这个比值称为DPR(Device Pixel Ration，设备像素比)。</li>
</ol>
<p>以Phone 5为例，它的设备像素为640/1136px，设备像素比为2，因此CSS像素为320/568px。设计师通常根据固定的设备像素进行设计，前端工程师再根据不同设备的特性，将物理像素转换为相应的逻辑像素。</p>
<h3 id="设备像素比"><a href="#设备像素比" class="headerlink" title="设备像素比"></a>设备像素比</h3><p>设备像素比缩写为DPR(Device Pixel Ratio)或者DPPX(Dots Per Pixel)，一般用于表示一个CSS像素等于几个物理像素：<code>DPR=物理像素/逻辑像素</code>。当dpr为2时，1个CSS像素由4个物理像素组成，可通过<code>window.devicePixelRatio</code>获取当前设备的dpr。</p>
<h3 id="像素密度"><a href="#像素密度" class="headerlink" title="像素密度"></a>像素密度</h3><p>像素密度也叫做屏幕密度，缩写为DPI(dots Per Inch)或PPI(Pixels Per Inch)。以iphone X举例，设备的参数如下：</p>
<ul>
<li>水平分辨率：2436px</li>
<li>垂直分辨率：1125px</li>
<li>屏幕对角线尺寸：5.8英寸</li>
</ul>
<p>为了计算像素密度，我们通常需要求出屏幕对角线的分辨率，再除以屏幕对角线尺寸。根据勾股定理(直角三角形的两条直角边的长度的平方和等于斜边长的平方)，得以下表达式：<br><img src="http://7xp5r4.com1.z0.glb.clouddn.com/18-2-6/69150988.jpg" alt=""></p>
<p>tricks：</p>
<ul>
<li>DPI与PPI其实指代的东西是不同的，需要注意语境，人们多为混用。</li>
<li>根据实验，普通人眼在一般阅读距离的极限就是300~400DPI，所以说目前的高清屏的DPI也在300左右。</li>
<li>普通的非彩色喷墨式打印机通常设定在300dpi，根据公式：<code>像素=英寸 x dpi</code>，可以通过调整图像像素大小，获取所需要的实际尺寸大小。</li>
</ul>
<h3 id="寸照究竟有多少像素？"><a href="#寸照究竟有多少像素？" class="headerlink" title="寸照究竟有多少像素？"></a>寸照究竟有多少像素？</h3><p>通过搜索，<code>1寸=2.5cm x 3.5cm=413 x 295</code>，聪明的你肯定不需要过多的说明，看以下换算公式：<br><img src="http://7xp5r4.com1.z0.glb.clouddn.com/18-2-6/99937072.jpg" alt=""></p>
<h2 id="viewport-视口"><a href="#viewport-视口" class="headerlink" title="viewport(视口)"></a>viewport(视口)</h2><p>viewport概念通常存在于移动端，因为pc端的视口大小与窗口相等，而在移动设备的浏览器中，一般视口的默认大小会比设备逻辑的独立像素要大，并可拖过手动缩放来浏览网页，这个窗口就称之为viewport，普通设备浏览器的默认viewport通常为980px或1024px，随之的副作用就是设备的横向滚动条。</p>
<h3 id="布局视口"><a href="#布局视口" class="headerlink" title="布局视口"></a>布局视口</h3><p>手机浏览器默认会去适应那些不是为移动端设计的网站，因此会为viewport设置一个默认值，一般为980px，这样大部分电脑端页面都能正常显示了，只是比例看起来很小，因此布局视口通常是大于浏览器可视区域，不进行缩放的情况也会有额外的额外滚动条，这个宽度可以通过<code>document.documentElement.clientWidth</code>来进行获取，它跟设备的大小没有关系。</p>
<h3 id="视觉视口"><a href="#视觉视口" class="headerlink" title="视觉视口"></a>视觉视口</h3><p>用户默认看到的网站区域，即为视觉视口大小，放大会使视觉视口大小变小，因为整个屏幕显示的CSS像素更少了，而缩小会使其变大，缩放不会影响布局视口大小。</p>
<h3 id="理想视口"><a href="#理想视口" class="headerlink" title="理想视口"></a>理想视口</h3><p>布局视口并不是一个理想宽度，对设备而言，设备宽度即是理想视口宽度，通常可见viewport的一个属性：<code>width=device-width</code>，这一行代码告诉浏览器将视口大小设置为理想视口大小。</p>
<h3 id="viewport标签"><a href="#viewport标签" class="headerlink" title="viewport标签"></a>viewport标签</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</div></pre></td></tr></table></figure>
<p>viewport标签专为移动端的设备而设计，以上是一个最常用的标签，它可以设置以下几个特性：</p>
<ul>
<li>width：viewport的宽度大小，如640，也可设置如device-width使其等于设备的宽度</li>
<li>height：viewport的高度</li>
<li>initial-scale：初始缩放比例</li>
<li>maximum-scale：允许用户缩放的最大比例</li>
<li>minimum-scale：允许用户缩放的最小比例</li>
<li>user-scalable：是否允许手动缩放</li>
</ul>
<h3 id="视口单位"><a href="#视口单位" class="headerlink" title="视口单位"></a>视口单位</h3><ul>
<li>vw，1vw等于视口宽度的1%</li>
<li>vh：1vh等于视口高度的1%</li>
<li>vmin：选取vw和vh中更小的一个</li>
<li>vmax：选取vw和vh中更大的一个</li>
</ul>
<p>视口单位与<strong>%</strong>很像，但一个依赖于视口大小，一个依赖于元素的父级，既然在此提出来了，那么视口单位有哪些作用呢？没错，主要是用于适配的。</p>
<p>在实际的项目中，通过将vw作为宽度，可以获取较适合的屏幕比例，高度不推荐使用，除非是设计师已经设计好了元素的比例，此时才应该使用vw单位作为宽度，在项目中通过任意一个预处理器的函数可将设计图上的像素计算为px，以下是我的stylus函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$mobile-screen = 640</div><div class="line">px2vw(px, device = $mobile-screen)</div><div class="line">  (px / device * 100)vw</div><div class="line">  </div><div class="line">px2vw(320) // 输出为50vw</div></pre></td></tr></table></figure>
<h2 id="适配解决方案"><a href="#适配解决方案" class="headerlink" title="适配解决方案"></a>适配解决方案</h2><h3 id="手机调试"><a href="#手机调试" class="headerlink" title="手机调试"></a>手机调试</h3><p><strong>首选方案</strong>，即启动开发服务器的时候，将端口设置为0.0.0.0，然后连接同一网段的ip进行访问。若需要真机调试的话，若没有服务器的话，可以使用ngrok进行代理，有服务器推荐使用frp，当然，做微信相关的开发，请使用微信开发者工具。</p>
<h3 id="REM的font-size设置为多少合适？"><a href="#REM的font-size设置为多少合适？" class="headerlink" title="REM的font-size设置为多少合适？"></a>REM的font-size设置为多少合适？</h3><p>常用浏览器的默认html的字体大小是16px，网上最流行将其设置为<code>font-size: 10px</code>或者是<code>font-size: 62.5%</code>，大家在使用rem前需要知道以下两点：</p>
<ol>
<li>以rem设置font-size，最小只能给元素设置为12px，若html的font-size为10px，那么给元素赋值<code>font-size: 1rem</code>，它的实际大小为10px。</li>
<li>以rem设置width/height，最小也只能接受12px以上的font-size值，若元素宽为2rem，对应font-size为10px时，它的实际大小为24px。</li>
</ol>
<p>因此非常不建议设置为12px以下，这样会造成<strong>计算不精准</strong>；也不建议设置如100px的大小，若忘记给元素设置font-size，<strong>默认值会影响整个页面</strong>的美观；因此建议设置范围在<strong>12-20</strong>之间。</p>
<h3 id="100-与100vw有什么区别？"><a href="#100-与100vw有什么区别？" class="headerlink" title="100%与100vw有什么区别？"></a>100%与100vw有什么区别？</h3><p>100vw是基于viewport的尺寸，会填满viewport，而100%占据全部可获得的空间。</p>
<p>需要注意的是，vw会忽略滚动条所占据的宽度，假如在有纵向滚动条的情况下，将元素宽度设置为100vw，那么横向就会出现一个很小的滚动条，在这种情况下应该使用100%。具体原因是因为当html和body的overflow:auto时滚动条不会从视口中减去，而overflow:scroll时视口就会减去滚动条占据的空间，也不会出现滚动条了。</p>
<h3 id="retina屏下border为1px的问题"><a href="#retina屏下border为1px的问题" class="headerlink" title="retina屏下border为1px的问题"></a>retina屏下border为1px的问题</h3><p>当在dpr为2的高清设计图看到border为1px时，其实设计师需要的是1个物理像素，转化为CSS像素就是0.5px，那么如何解决呢？在此简单总结为以下方法：</p>
<p>一、通过JavaScript检测浏览器的dpr，从而给html添加一个类名，再到需要处理的样式的地方写一套权重更高的样式表。但是这样的解决方法并不兼容部分老设备，但我相信随着时间的推移，兼容性的问题也会大大减少吧。</p>
<p>二、动态设置viewport标签，假设机型为phone5时，可设置为如下viewport，这样页面中所有border:1px都将缩小为0.5：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=640,initial-scale=0.5,maximum-scale=0.5, minimum-scale=0.5,user-scalable=no&quot;&gt;</div></pre></td></tr></table></figure>
<p>在实际使用时请参考某网站的JavaScript动态计算dpr、rem、viewport的方式。</p>
<h2 id="开发工具"><a href="#开发工具" class="headerlink" title="开发工具"></a>开发工具</h2><p><a href="https://www.sven.de/dpi/" target="_blank" rel="external">移动设备分辨率与DPI集合</a></p>
<p><a href="http://dpi.lv/" target="_blank" rel="external">设备dpi/dpr</a></p>
<p><a href="https://github.com/inconshreveable/ngrok" target="_blank" rel="external">ngrok</a>，调试工具</p>
<p><a href="https://github.com/fatedier/frp" target="_blank" rel="external">frp</a>，调试工具</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="http://www.cnblogs.com/lyzg/p/4877277.html" target="_blank" rel="external">从网易与淘宝的font-size思考前端设计稿与工作流 - 流云诸葛 - 博客园</a></p>
<p><a href="https://www.w3cplus.com/css/viewports.html" target="_blank" rel="external">viewports剖析</a></p>
<p><a href="https://webdesign.tutsplus.com/zh-hans/tutorials/comprehensive-guide-when-to-use-em-vs-rem--cms-23984" target="_blank" rel="external">综合指南: 何时使用 Em 与 Rem</a></p>
<p><a href="http://www.ayqy.net/blog/%E5%AE%8C%E5%85%A8%E7%90%86%E8%A7%A3px-dpr-dpi-dip/" target="_blank" rel="external">完全理解px-dpr-dpi-dip</a></p>
</article><div id="commenter"></div><div id="footer"><div>vv13 &copy; 2017<a class="ama" href="https://github.com/vv13/ama" target="_blank">Ask Me Anything</a></div><div class="shortcut"><a href="/atom.xml"><i class="iconfont icon-rss" aria-hidden="true"></i></a><a href="https://github.com/vv13"><i class="iconfont icon-github" aria-hidden="true"></i></a></div></div><div class="side-menu"><div class="shortcut" id="goHome"><a href="/"><i class="icon-home iconfont" aria-hidden="true"></i></a></div><div class="shortcut" id="goTop"><i class="icon-yijiantisheng iconfont" aria-hidden="true"></i></div></div></div><script src="/js/vv13.js"></script><div id="container"></div></body></html>