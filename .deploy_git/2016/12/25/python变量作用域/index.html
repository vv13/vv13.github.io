<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"><title>vv13</title><link rel="stylesheet" href="/css/vv13.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_438575_w9o3rescwyp919k9.css"><link rel="icon" href="/undefined"></head><body><div id="content-outer"><link rel="stylesheet" href="/css/github-markdown.css"><article class="markdown-body" id="post"><h1 class="article-title">python变量作用域</h1><div class="title-info"><time class="post-time" datetime="2016-12-25T15:43:05.000Z">12.25, 2016</time><div class="title-item"><a href="/tags/python/"><i class="iconfont icon-tag">python</i></a></div></div><p>class比作整个屋子，def为卧室，class外面的部分就是小区环境。</p>
<h4 id="首先测试房子-class-与公共设施变量-globals-之间的关系"><a href="#首先测试房子-class-与公共设施变量-globals-之间的关系" class="headerlink" title="首先测试房子(class)与公共设施变量(globals)之间的关系"></a>首先测试房子(class)与公共设施变量(globals)之间的关系</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># encoding: utf-8</div><div class="line"></div><div class="line">PUBLIC_FACILITIES = u&quot;公共厕所&quot;</div><div class="line"></div><div class="line">class House():</div><div class="line">    print PUBLIC_FACILITIES</div><div class="line">    PUBLIC_FACILITIES = &apos;改造&apos;</div><div class="line"></div><div class="line">if __name__ == &apos;__main__&apos;:</div><div class="line">    test = House()</div><div class="line">    print PUBLIC_FACILITIES</div></pre></td></tr></table></figure>
<p>测试结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">公共厕所</div><div class="line">公共厕所</div><div class="line"></div><div class="line">***Repl Closed***</div></pre></td></tr></table></figure>
<p>房屋的拥有者可以使用小区内的公共设施。由此可知class内部可以访问外部的变量，但不能进行修改，在class中执行改造命令的效果就是新建了一个类局部变量变量，在访问域中覆盖了全局变量的访问域。</p>
<h4 id="测试房子-class-与房间-def-的关系"><a href="#测试房子-class-与房间-def-的关系" class="headerlink" title="测试房子(class)与房间(def)的关系"></a>测试房子(class)与房间(def)的关系</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"># encoding: utf-8</div><div class="line"></div><div class="line">class House():</div><div class="line">    SOFA = u&apos;真皮沙发&apos;</div><div class="line">    def room(self):</div><div class="line">        # print SOFA # 无法直接访问外部变量，取消注释会报错</div><div class="line">        print self.SOFA</div><div class="line">        self.SOFA = &apos;布质沙发&apos;</div><div class="line"></div><div class="line"></div><div class="line">if __name__ == &apos;__main__&apos;:</div><div class="line">    test = House()</div><div class="line">    test.room()</div><div class="line">    print test.SOFA, House.SOFA</div></pre></td></tr></table></figure>
<p>测试结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">真皮沙发</div><div class="line">布质沙发 真皮沙发</div><div class="line"></div><div class="line">***Repl Closed***</div></pre></td></tr></table></figure>
<p>大家可以理解这样一个现象：无法将客厅的沙发放到卧室(卧室太小)，只能重新订制一个沙发，或是在客厅里去使用。当def方法中不存在与class类相同名称的变量时，def方法体中可以通过self访问到class的类变量， 但是当执行self.SOFA = Something时，新建了一个变量实例变量，并没有修改到class中的类变量， 而变量的搜索时先从局部变量进行查找，如果没有找到再查找全局变量，所有说局部变量优先访问到。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>用python写class时务必区分类变量、实例变量、全局变量，  访问全局变量须申明<code>global variable</code>， 访问类变量要接上类名，如<code>class_name.variable</code>, 还需要注意的时while、for、try语句并不具有独立的命名空间，这与java的规则是不一样的。</p>
</article><div id="commenter"></div><link rel="stylesheet" href="/css/dark.css"><script src="/js/gitment.js"></script><script>var gitment = new Gitment({
owner: 'vv13',
repo: 'vv13.github.io',
oauth: {
    client_id: 'fc26f0c5db6ee176856d',
    client_secret: 'adaddc022d70102d2f037f675d0b29a13d5283dd',
},
})
gitment.render('commenter')</script><div id="footer"><div>vv13 &copy; 2017</div><div class="shortcut"><a href="/atom.xml"><i class="iconfont icon-rss" aria-hidden="true"></i></a><a href="https://github.com/vv13"><i class="iconfont icon-github" aria-hidden="true"></i></a></div></div><div class="side-menu"><div class="shortcut" id="goHome"><a href="/"><i class="icon-home iconfont" aria-hidden="true"></i></a></div><div class="shortcut" id="goTop"><i class="icon-yijiantisheng iconfont" aria-hidden="true"></i></div></div></div><script src="/js/vv13.js"></script><div id="container"></div></body></html>